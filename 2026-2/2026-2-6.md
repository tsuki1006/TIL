# 2026.2.6

> #### 🎈3.5（累計時間 260.0h）

## 作業内容

- 上級課題
  - request test（途中）

## 学び
- request specでresponseのフォーマットをjsonに指定したいとき  
  `get article_comments_path(article_id: article.id), as: :json`

- Serializer で asset_path（Viewヘルパー）を使うときはActionController::Base.helpers から借りてくる

### APIでbefore_action :authenticate_user!を使いたいときの注意点  
<u>Deviseは、**誰が何のリクエストを送ってきたか**によって挙動を変える</u>  
- ブラウザからの普通のリクエスト：未ログインなら ログイン画面へリダイレクト（302）
- APIからのリクエスト：未ログインなら 「権限なし（401）」というデータを返す

**↓　APIを叩くときはどちらかを徹底**
  - `/articles.json`とURLに拡張子を明示してリクエストを飛ばす(JSON形式（API）と認識してくれる)
  - リクエストにヘッダーを含める
    ```JavaScript
    headers: {
        'Content-Type': 'application/json',
        'Accept': 'application/json'
    }
    ```
## MEMO
後で読みたい

【Rails】json形式のレスポンスを整形して、画像ファイルのURLをフロントに渡す方法
https://qiita.com/Omi354/items/4c320fc43ae48ed806ed

serializerでのデータの扱いにて、自分のやった方法よりスマート。serializerでできることを新しく知ることができる。
（特にモデルのassociationのあたりについて）

---

- Draper (gem) について